<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphMind - Hybrid Vector+Graph Database</title>
    <script src="https://unpkg.com/cytoscape@3.27.0/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-glass: rgba(255, 255, 255, 0.05);
            --bg-glass-hover: rgba(255, 255, 255, 0.08);
            --border-glass: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-muted: rgba(255, 255, 255, 0.5);
            --shadow-glass: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
        }

        .glass {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            border-radius: 20px;
            box-shadow: var(--shadow-glass);
        }

        .glass-strong {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        /* Landing Page */
        #landing-page {
            position: relative;
        }

        .landing-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            padding: 100px 20px;
            overflow: hidden;
        }

        .landing-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.02) 0%, transparent 50%);
            pointer-events: none;
        }

        .section-content {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            z-index: 1;
            position: relative;
        }

        /* Hero Section */
        .hero {
            text-align: center;
        }

        .hero h1 {
            font-size: clamp(3rem, 8vw, 6rem);
            font-weight: 800;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #ffffff 0%, rgba(255, 255, 255, 0.7) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.02em;
        }

        .hero p {
            font-size: clamp(1.2rem, 2vw, 1.5rem);
            color: var(--text-secondary);
            margin-bottom: 50px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Features Section */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 60px;
        }

        .feature-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            border-radius: 20px;
            padding: 40px;
            transition: all 0.3s;
        }

        .feature-card:hover {
            background: var(--bg-glass-hover);
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .feature-card p {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* Stats Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-top: 60px;
        }

        .stat-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ffffff 0%, rgba(255, 255, 255, 0.7) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Files Section */
        .files-section {
            margin-top: 60px;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .file-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .file-card:hover {
            background: var(--bg-glass-hover);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .file-card .file-name {
            font-weight: 600;
            margin-bottom: 10px;
            word-break: break-all;
        }

        .file-card .file-size {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .file-card .delete-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .file-card .delete-btn:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        /* Graph Preview Section */
        .graph-preview {
            margin-top: 60px;
            min-height: 400px;
        }

        #preview-graph {
            width: 100%;
            height: 400px;
            border: 1px solid var(--border-glass);
            border-radius: 20px;
            background: var(--bg-secondary);
        }

        /* CTA Section */
        .cta-section {
            text-align: center;
            margin-top: 60px;
        }

        .cta-button {
            display: inline-block;
            padding: 18px 45px;
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 50px;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.4s;
            backdrop-filter: blur(20px);
            cursor: pointer;
            margin: 10px;
        }

        .cta-button:hover {
            background: var(--bg-glass-hover);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        /* App Container */
        .app-container {
            display: none;
            min-height: 100vh;
        }

        .app-container.active {
            display: block;
        }

        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 20px;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-glass);
        }

        .app-header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
        }

        .nav-tab {
            padding: 12px 24px;
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-tab:hover {
            background: var(--bg-glass-hover);
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .main-content {
            max-width: 1400px;
            margin: 100px auto 40px;
            padding: 0 20px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .card h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        /* Onboarding Popup System */
        .onboarding-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        .onboarding-overlay.active {
            display: flex;
        }

        .onboarding-popup {
            background: var(--bg-glass-strong);
            backdrop-filter: blur(30px);
            border: 1px solid var(--border-glass);
            border-radius: 24px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .onboarding-popup h2 {
            font-size: 2rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .onboarding-popup p {
            color: var(--text-secondary);
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .onboarding-popup .step-indicator {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .step-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--text-muted);
            transition: all 0.3s;
        }

        .step-dot.active {
            background: var(--text-primary);
            transform: scale(1.3);
        }

        .popup-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .btn {
            padding: 12px 30px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-size: 1rem;
        }

        .btn-primary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-glass);
            color: var(--text-primary);
        }

        .btn-primary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border-glass);
            color: var(--text-secondary);
        }

        .btn-secondary:hover {
            color: var(--text-primary);
        }
        
        .autofill-btn {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #3b82f6;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-left: 10px;
        }
        
        .autofill-btn:hover {
            background: rgba(59, 130, 246, 0.2);
        }

        /* Common Styles */
        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 18px 24px;
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.3);
            background: var(--bg-glass-hover);
        }

        .search-box {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .upload-zone {
            border: 2px dashed var(--border-glass);
            border-radius: 20px;
            padding: 60px;
            text-align: center;
            transition: all 0.3s;
            background: var(--bg-glass);
            cursor: pointer;
        }

        .upload-zone.dragover {
            border-color: rgba(255, 255, 255, 0.3);
            background: var(--bg-glass-hover);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s;
        }

        .result-card:hover {
            background: var(--bg-glass-hover);
            transform: translateY(-4px);
        }

        .processing-animation {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .processing-animation.active {
            display: block;
        }

        .processing-steps {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
        }

        .processing-step {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 12px;
            padding: 20px;
            opacity: 0.5;
            transition: all 0.5s;
        }

        .processing-step.active {
            opacity: 1;
            background: var(--bg-glass-hover);
            transform: translateX(10px);
        }

        .processing-step.completed::before {
            content: '‚úì ';
            color: #4ade80;
            font-weight: bold;
            margin-right: 10px;
        }

        .message {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .message.success {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid rgba(74, 222, 128, 0.3);
            color: #4ade80;
        }

        .message.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        #graph-container, #traversal-graph-container {
            width: 100%;
            height: 600px;
            border: 1px solid var(--border-glass);
            border-radius: 20px;
            background: var(--bg-secondary);
            margin-bottom: 30px;
        }

        .markdown-content {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: var(--text-primary);
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .markdown-content strong {
            color: var(--text-primary);
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: var(--text-secondary);
        }

        .spinner {
            border: 3px solid var(--border-glass);
            border-top: 3px solid var(--text-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-glass);
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landing-page">
        <!-- Single Hero Section -->
        <section class="landing-section" id="hero-section">
            <div class="section-content">
                <div class="hero">
                    <h1>GraphMind</h1>
                    <p style="font-size: clamp(1.2rem, 2vw, 1.8rem); margin-bottom: 20px;">Hybrid Vector + Graph Database for Intelligent AI Retrieval</p>
                    <p style="font-size: clamp(1rem, 1.5vw, 1.2rem); color: var(--text-secondary); margin-bottom: 40px; max-width: 800px; margin-left: auto; margin-right: auto;">
                        Transform your documents into intelligent knowledge graphs. Search semantically, traverse relationships, and discover insights with AI-powered explanations.
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-bottom: 60px;">
                        <button class="cta-button" onclick="startApp()">Launch Application</button>
                        <button class="cta-button" onclick="clearAllData()" style="background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); color: #ef4444;">Clear All Data</button>
                    </div>
                    
                    <!-- Stats in Hero -->
                    <div class="stats-grid" style="max-width: 800px; margin: 0 auto;">
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-nodes">0</div>
                            <div class="stat-label">Knowledge Nodes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-edges">0</div>
                            <div class="stat-label">Relationships</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-vectors">0</div>
                            <div class="stat-label">Vector Embeddings</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-files">0</div>
                            <div class="stat-label">Uploaded Files</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Main Application -->
    <div id="app-container" class="app-container">
        <div class="app-header">
            <div class="app-header-content">
                <div class="logo">GraphMind</div>
                <div class="nav-tabs">
                    <div class="nav-tab active" onclick="switchTab('upload')" data-tab="upload">Upload</div>
                    <div class="nav-tab" onclick="switchTab('search')" data-tab="search">Search</div>
                    <div class="nav-tab" onclick="switchTab('compare')" data-tab="compare">Compare</div>
                    <div class="nav-tab" onclick="switchTab('crud')" data-tab="crud">CRUD</div>
                    <div class="nav-tab" onclick="switchTab('nodes')" data-tab="nodes">Nodes</div>
                    <div class="nav-tab" onclick="switchTab('traversal')" data-tab="traversal">Traversal</div>
                    <div class="nav-tab" onclick="switchTab('graph')" data-tab="graph">Graph</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- Upload Tab -->
            <div id="upload-tab" class="tab-content active">
                <div class="card">
                    <h2>Upload Files</h2>
                    <div class="upload-zone" id="upload-zone">
                        <p style="font-size: 1.2rem; margin-bottom: 20px; color: var(--text-secondary);">
                            Drag and drop files here or click to browse
                        </p>
                        <input type="file" id="file-input" multiple accept=".txt,.pdf,.xml,.json,.csv,.md">
                        <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">Choose Files</button>
                        <button class="autofill-btn" onclick="autofillUpload()">üéØ Autofill Demo</button>
                        <div style="margin-top: 20px;">
                            <label style="color: var(--text-secondary); margin-right: 10px;">File Type:</label>
                            <select id="file-type" class="search-input" style="display: inline-block; width: auto; min-width: 150px;">
                                <option value="text">Text (.txt)</option>
                                <option value="pdf">PDF (.pdf)</option>
                                <option value="xml">XML (.xml)</option>
                                <option value="json">JSON (.json)</option>
                                <option value="csv">CSV (.csv)</option>
                            </select>
                        </div>
                    </div>
                    <div id="upload-status"></div>
                    <div id="processing-animation" class="processing-animation">
                        <div class="spinner"></div>
                        <h3>Processing Your File...</h3>
                        <div class="processing-steps" id="processing-steps"></div>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-nodes">0</div>
                        <div class="stat-label">Nodes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-edges">0</div>
                        <div class="stat-label">Edges</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-vectors">0</div>
                        <div class="stat-label">Vectors</div>
                    </div>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search-tab" class="tab-content">
                <div class="card">
                    <h2>Search Knowledge Graph</h2>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid var(--border-glass); padding-bottom: 20px;">
                        <div class="nav-tab active" id="search-tab-vector" onclick="switchSearchMode('vector')">Vector</div>
                        <div class="nav-tab" id="search-tab-graph" onclick="switchSearchMode('graph')">Graph</div>
                        <div class="nav-tab" id="search-tab-hybrid" onclick="switchSearchMode('hybrid')">Hybrid</div>
                    </div>
                    
                    <div id="search-vector" class="search-mode-content">
                        <div class="search-box">
                            <input type="text" id="vector-query" class="search-input" placeholder="Enter query for vector search...">
                            <input type="number" id="vector-top-k" class="search-input" value="5" min="1" max="50" style="width: 120px;" placeholder="Top K">
                            <button class="btn btn-primary" onclick="performVectorSearch()">Search</button>
                            <button class="autofill-btn" onclick="autofillVectorSearch()">üéØ Autofill</button>
                        </div>
                    </div>
                    
                    <div id="search-graph" class="search-mode-content" style="display: none;">
                        <div class="search-box">
                            <input type="text" id="traversal-start-id" class="search-input" placeholder="Enter start node ID...">
                            <input type="number" id="traversal-depth" class="search-input" value="3" min="1" max="10" style="width: 120px;" placeholder="Depth">
                            <input type="number" id="traversal-max-nodes" class="search-input" value="100" min="1" max="1000" style="width: 150px;" placeholder="Max Nodes">
                            <button class="btn btn-primary" onclick="performGraphTraversal()">Traverse</button>
                            <button class="autofill-btn" onclick="autofillGraphTraversal()">üéØ Autofill</button>
                        </div>
                    </div>
                    
                    <div id="search-hybrid" class="search-mode-content" style="display: none;">
                        <div class="search-box">
                            <input type="text" id="hybrid-query" class="search-input" placeholder="Enter query for hybrid search...">
                            <input type="number" id="hybrid-vector-weight" class="search-input" value="0.6" min="0" max="1" step="0.1" style="width: 150px;" placeholder="Vector Weight">
                            <input type="number" id="hybrid-graph-weight" class="search-input" value="0.4" min="0" max="1" step="0.1" style="width: 150px;" placeholder="Graph Weight">
                            <input type="number" id="hybrid-top-k" class="search-input" value="5" min="1" max="50" style="width: 120px;" placeholder="Top K">
                            <button class="btn btn-primary" onclick="performHybridSearch()">Search</button>
                            <button class="autofill-btn" onclick="autofillHybridSearch()">üéØ Autofill</button>
                        </div>
                    </div>
                    
                    <div id="search-results" class="results-grid"></div>
                    <div id="llm-answer-container"></div>
                </div>
            </div>

            <!-- Compare Tab -->
            <div id="compare-tab" class="tab-content">
                <div class="card">
                    <h2>Compare Search Methods</h2>
                    <div class="search-box">
                        <input type="text" id="compare-query" class="search-input" placeholder="Enter query to compare all methods...">
                        <button class="btn btn-primary" onclick="performCompare()">Compare</button>
                        <button class="autofill-btn" onclick="autofillCompare()">üéØ Autofill</button>
                    </div>
                    <div id="comparison-results"></div>
                </div>
            </div>

            <!-- Nodes Tab -->
            <div id="nodes-tab" class="tab-content">
                <div class="card">
                    <h2>Node Management</h2>
                    <div class="search-box">
                        <input type="text" id="node-lookup-id" class="search-input" placeholder="Enter node ID to view/edit...">
                        <button class="btn btn-primary" onclick="lookupNode()">View Node</button>
                        <button class="autofill-btn" onclick="autofillNodeLookup()">üéØ Autofill</button>
                    </div>
                    <div id="node-details-container"></div>
                </div>
            </div>
            
            <!-- CRUD Operations Tab -->
            <div id="crud-tab" class="tab-content">
                <div class="card">
                    <h2>CRUD Operations</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div class="card" style="margin-bottom: 0;">
                            <h3 style="font-size: 1.5rem; margin-bottom: 15px;">Create Node</h3>
                            <div style="display: flex; flex-direction: column; gap: 15px;">
                                <input type="text" id="create-node-id" class="search-input" placeholder="Node ID (optional)">
                                <textarea id="create-node-content" class="search-input" placeholder="Node content..." style="min-height: 100px;"></textarea>
                                <input type="text" id="create-node-type" class="search-input" placeholder="Node type (optional)">
                                <button class="btn btn-primary" onclick="createNode()">Create Node</button>
                                <button class="autofill-btn" onclick="autofillCreateNode()">üéØ Autofill</button>
                            </div>
                        </div>
                        <div class="card" style="margin-bottom: 0;">
                            <h3 style="font-size: 1.5rem; margin-bottom: 15px;">Create Edge</h3>
                            <div style="display: flex; flex-direction: column; gap: 15px;">
                                <input type="text" id="create-edge-source" class="search-input" placeholder="Source node ID">
                                <input type="text" id="create-edge-target" class="search-input" placeholder="Target node ID">
                                <input type="text" id="create-edge-relationship" class="search-input" placeholder="Relationship type">
                                <input type="number" id="create-edge-weight" class="search-input" value="1.0" min="0" max="1" step="0.1" placeholder="Weight (0-1)">
                                <button class="btn btn-primary" onclick="createEdge()">Create Edge</button>
                                <button class="autofill-btn" onclick="autofillCreateEdge()">üéØ Autofill</button>
                            </div>
                        </div>
                    </div>
                    <div id="crud-status"></div>
                </div>
            </div>

            <!-- Traversal Tab -->
            <div id="traversal-tab" class="tab-content">
                <div class="card">
                    <h2>Graph Traversal</h2>
                    <div class="search-box">
                        <input type="text" id="traversal-start" class="search-input" placeholder="Enter start node ID...">
                        <label style="color: var(--text-secondary);">Depth: <span id="depth-value">3</span></label>
                        <input type="range" id="traversal-depth-slider" min="1" max="10" value="3" 
                               oninput="document.getElementById('depth-value').textContent = this.value"
                               style="flex: 1; max-width: 200px;">
                        <input type="number" id="traversal-max" class="search-input" value="100" min="1" max="1000" style="width: 150px;" placeholder="Max Nodes">
                        <button class="btn btn-primary" onclick="performTraversal()">Start Traversal</button>
                        <button class="autofill-btn" onclick="autofillTraversal()">üéØ Autofill</button>
                    </div>
                    <div id="traversal-results"></div>
                    <div id="traversal-graph-container"></div>
                </div>
            </div>

            <!-- Graph Tab -->
            <div id="graph-tab" class="tab-content">
                <div class="card">
                    <h2>Interactive Graph Visualization</h2>
                    <button class="btn btn-primary" onclick="loadGraph()" style="margin-bottom: 20px;">Refresh Graph</button>
                    <div id="graph-container"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Onboarding Overlay -->
    <div id="onboarding-overlay" class="onboarding-overlay">
        <div class="onboarding-popup">
            <div class="step-indicator" id="step-indicator"></div>
            <h2 id="onboarding-title">Welcome to GraphMind</h2>
            <p id="onboarding-content"></p>
            <div class="popup-buttons">
                <button class="btn btn-secondary" onclick="skipOnboarding()">Skip</button>
                <button class="btn btn-primary" onclick="nextOnboardingStep()" id="onboarding-next">Next</button>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://127.0.0.1:8000';
        let cy = null;
        let onboardingStep = 0;
        let onboardingSteps = [];

        // Initialize onboarding steps
        function initOnboarding() {
            onboardingSteps = [
                {
                    title: "Welcome to GraphMind",
                    content: "GraphMind is a hybrid vector + graph database that combines semantic similarity search with relational knowledge graphs. Let's get you started!"
                },
                {
                    title: "Step 1: Upload Your First File",
                    content: "Start by uploading a document. Supported formats include text, PDF, XML, JSON, and CSV. The system will automatically extract entities and create a knowledge graph."
                },
                {
                    title: "Step 2: Watch the Magic Happen",
                    content: "After uploading, you'll see the file being processed in real-time. Watch as it's converted into graph nodes and vector embeddings that power intelligent search."
                },
                {
                    title: "Step 3: CRUD Operations",
                    content: "Use the CRUD tab to create new nodes and edges manually. You can build your knowledge graph step by step with full control."
                },
                {
                    title: "Step 4: Explore Node Management",
                    content: "View, edit, and delete nodes through the Nodes tab. Each node represents a concept or entity with relationships to other nodes."
                },
                {
                    title: "Step 5: Ask Your First Query",
                    content: "Try searching for something! Use Vector search for semantic similarity, Graph search for relational traversal, or Hybrid search for the best of both worlds."
                },
                {
                    title: "Step 6: Compare Search Methods",
                    content: "See how different search methods perform side-by-side. The system will explain why it chose certain results using AI-powered reasoning."
                },
                {
                    title: "Step 7: Traverse the Graph",
                    content: "Explore connections between nodes by starting a traversal from any node. See how concepts relate to each other through the graph structure."
                },
                {
                    title: "Step 8: Interactive Visualization",
                    content: "Click on nodes in the graph visualization to interact with them. You can view details, see vector embeddings, and explore the complete knowledge graph."
                }
            ];
        }

        function startApp() {
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById('app-container').classList.add('active');
            initOnboarding();
            showOnboarding();
            loadStats();
        }

        function showOnboarding() {
            onboardingStep = 0;
            updateOnboardingUI();
            document.getElementById('onboarding-overlay').classList.add('active');
        }

        function updateOnboardingUI() {
            const step = onboardingSteps[onboardingStep];
            if (!step) {
                skipOnboarding();
                return;
            }

            document.getElementById('onboarding-title').textContent = step.title;
            document.getElementById('onboarding-content').textContent = step.content;
            
            // Update step indicator
            const indicator = document.getElementById('step-indicator');
            indicator.innerHTML = '';
            for (let i = 0; i < onboardingSteps.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'step-dot' + (i === onboardingStep ? ' active' : '');
                indicator.appendChild(dot);
            }

            // Update button text
            const nextBtn = document.getElementById('onboarding-next');
            if (onboardingStep === onboardingSteps.length - 1) {
                nextBtn.textContent = 'Get Started';
            } else {
                nextBtn.textContent = 'Next';
            }
        }

        function nextOnboardingStep() {
            onboardingStep++;
            if (onboardingStep >= onboardingSteps.length) {
                skipOnboarding();
            } else {
                updateOnboardingUI();
            }
        }

        function skipOnboarding() {
            document.getElementById('onboarding-overlay').classList.remove('active');
        }

        function startApp() {
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById('app-container').classList.add('active');
            loadStats();
            refreshFiles();
            loadPreviewGraph();
        }

        function switchTab(tabName) {
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            
            document.querySelector(`[data-tab="${tabName}"]`)?.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            
            if (tabName === 'graph') {
                setTimeout(() => loadGraph(), 100);
            } else if (tabName === 'upload') {
                loadStats();
            }
        }

        function switchSearchMode(mode) {
            document.querySelectorAll('#search-tab-vector, #search-tab-graph, #search-tab-hybrid').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.search-mode-content').forEach(c => c.style.display = 'none');
            
            document.getElementById('search-tab-' + mode).classList.add('active');
            document.getElementById('search-' + mode).style.display = 'block';
        }

        // File management
        async function refreshFiles() {
            try {
                const response = await fetch(`${API_BASE}/files`);
                const data = await response.json();
                
                const container = document.getElementById('files-container');
                if (data.files && data.files.length > 0) {
                    container.innerHTML = data.files.map(file => `
                        <div class="file-card">
                            <div class="file-name">${file.filename}</div>
                            <div class="file-size">${file.size_mb} MB</div>
                            <button class="delete-btn" onclick="deleteFile('${file.filename}')">Delete</button>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p style="text-align: center; color: var(--text-secondary); grid-column: 1/-1;">No files uploaded yet</p>';
                }
                
                document.getElementById('landing-stat-files').textContent = data.count || 0;
            } catch (error) {
                console.error('Failed to load files:', error);
            }
        }

        async function deleteFile(filename) {
            if (!confirm(`Delete ${filename}?`)) return;
            
            try {
                const response = await fetch(`${API_BASE}/files/${encodeURIComponent(filename)}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    refreshFiles();
                } else {
                    alert('Failed to delete file');
                }
            } catch (error) {
                alert('Error deleting file: ' + error.message);
            }
        }

        // Stats loading
        async function loadStats() {
            try {
                const response = await fetch(`${API_BASE}/stats`);
                const stats = await response.json();
                const nodeCount = Math.floor(stats.node_count);
                const edgeCount = Math.floor(stats.edge_count);
                const vectorCount = Math.floor(stats.vector_count);
                
                document.getElementById('stat-nodes').textContent = nodeCount;
                document.getElementById('stat-edges').textContent = edgeCount;
                document.getElementById('stat-vectors').textContent = vectorCount;
                
                document.getElementById('landing-stat-nodes').textContent = nodeCount;
                document.getElementById('landing-stat-edges').textContent = edgeCount;
                document.getElementById('landing-stat-vectors').textContent = vectorCount;
            } catch (error) {
                console.error('Failed to load stats:', error);
            }
        }

        // File upload
        const uploadZone = document.getElementById('upload-zone');
        const fileInput = document.getElementById('file-input');

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                uploadFile(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                uploadFile(e.target.files[0]);
            }
        });

        async function uploadFile(file) {
            const statusDiv = document.getElementById('upload-status');
            const processingDiv = document.getElementById('processing-animation');
            const stepsDiv = document.getElementById('processing-steps');
            
            statusDiv.innerHTML = '';
            processingDiv.classList.add('active');
            
            const steps = [
                { text: 'Reading file...', id: 'step1' },
                { text: 'Parsing content...', id: 'step2' },
                { text: 'Extracting entities...', id: 'step3' },
                { text: 'Creating graph nodes...', id: 'step4' },
                { text: 'Generating embeddings...', id: 'step5' },
                { text: 'Building relationships...', id: 'step6' },
                { text: 'Finalizing...', id: 'step7' }
            ];
            
            stepsDiv.innerHTML = steps.map(s => 
                `<div class="processing-step" id="${s.id}">${s.text}</div>`
            ).join('');
            
            let currentStep = 0;
            const stepInterval = setInterval(() => {
                if (currentStep > 0) {
                    document.getElementById(steps[currentStep - 1].id).classList.add('completed');
                    document.getElementById(steps[currentStep - 1].id).classList.remove('active');
                }
                if (currentStep < steps.length) {
                    document.getElementById(steps[currentStep].id).classList.add('active');
                    currentStep++;
                } else {
                    clearInterval(stepInterval);
                }
            }, 800);
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('file_type', document.getElementById('file-type').value);
            formData.append('metadata', '{}');

            try {
                const response = await fetch(`${API_BASE}/ingest`, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                clearInterval(stepInterval);
                steps.forEach(s => {
                    const el = document.getElementById(s.id);
                    if (el) {
                        el.classList.add('completed');
                        el.classList.remove('active');
                    }
                });
                
                setTimeout(() => {
                    processingDiv.classList.remove('active');
                }, 1000);
                
                if (result.status === 'success' || result.status === 'ok') {
                    statusDiv.innerHTML = `<div class="message success">
                        ‚úÖ Upload successful!<br>
                        Nodes created: ${result.nodes_created || 0}<br>
                        Edges created: ${result.edges_created || 0}
                    </div>`;
                    loadStats();
                    refreshFiles();
                    loadPreviewGraph();
                    
                } else {
                    statusDiv.innerHTML = `<div class="message error">‚ùå Error: ${result.error || result.detail || 'Unknown error'}</div>`;
                }
            } catch (error) {
                processingDiv.classList.remove('active');
                statusDiv.innerHTML = `<div class="message error">‚ùå Upload failed: ${error.message}</div>`;
            }
        }
        

        // Search functions (keeping existing implementations)
        async function performVectorSearch() {
            const query = document.getElementById('vector-query').value;
            const topK = parseInt(document.getElementById('vector-top-k').value) || 5;
            const resultsDiv = document.getElementById('search-results');
            
            if (!query.trim()) {
                alert('Please enter a search query');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Searching...</div>';

            try {
                const response = await fetch(`${API_BASE}/search/vector`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ query_text: query, top_k: topK })
                });

                const data = await response.json();
                displaySearchResults(data.results);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Search failed: ${error.message}</div>`;
            }
        }

        async function performGraphTraversal() {
            const startId = document.getElementById('traversal-start-id').value;
            const depth = parseInt(document.getElementById('traversal-depth').value) || 3;
            const maxNodes = parseInt(document.getElementById('traversal-max-nodes').value) || 100;
            const resultsDiv = document.getElementById('search-results');
            
            if (!startId.trim()) {
                alert('Please enter a start node ID');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Traversing graph...</div>';

            try {
                const response = await fetch(`${API_BASE}/search/graph?start_id=${encodeURIComponent(startId)}&depth=${depth}&max_nodes=${maxNodes}`);
                const data = await response.json();
                
                if (data.nodes && data.nodes.length > 0) {
                    resultsDiv.innerHTML = `
                        <h3 style="margin-bottom: 20px;">Traversal Results (Depth: ${data.depth})</h3>
                        <div class="results-grid">
                            ${data.nodes.map(node => `
                                <div class="result-card">
                                    <h3>${node.node_id}</h3>
                                    <div class="score" style="display: inline-block; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; margin-bottom: 12px;">Distance: ${node.distance}</div>
                                    <div class="content" style="color: var(--text-secondary);">${node.content.substring(0, 200)}...</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = '<div class="message error">No nodes found in traversal</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Graph traversal failed: ${error.message}</div>`;
            }
        }

        async function performHybridSearch() {
            const query = document.getElementById('hybrid-query').value;
            const vectorWeight = parseFloat(document.getElementById('hybrid-vector-weight').value) || 0.6;
            const graphWeight = parseFloat(document.getElementById('hybrid-graph-weight').value) || 0.4;
            const topK = parseInt(document.getElementById('hybrid-top-k').value) || 5;
            const resultsDiv = document.getElementById('search-results');
            const answerDiv = document.getElementById('llm-answer-container');
            
            if (!query.trim()) {
                alert('Please enter a search query');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Performing hybrid search...</div>';
            answerDiv.innerHTML = '';

            try {
                const response = await fetch(`${API_BASE}/search/hybrid`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        query_text: query,
                        vector_weight: vectorWeight,
                        graph_weight: graphWeight,
                        top_k: topK
                    })
                });

                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    displaySearchResults(data.results.map(r => ({
                        node_id: r.node_id,
                        content: r.content,
                        score: r.score,
                        metadata: r.metadata
                    })));
                    
                    await getLLMExplanation(query, data.results);
                } else {
                    resultsDiv.innerHTML = '<div class="message error">No results found</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Hybrid search failed: ${error.message}</div>`;
            }
        }

        function displaySearchResults(results) {
            const resultsDiv = document.getElementById('search-results');
            
            if (!results || results.length === 0) {
                resultsDiv.innerHTML = '<div class="message error">No results found</div>';
                return;
            }

            resultsDiv.innerHTML = results.map(result => `
                <div class="result-card">
                    <h3>${result.node_id}</h3>
                    <div class="score" style="display: inline-block; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; margin-bottom: 12px;">Score: ${result.score.toFixed(3)}</div>
                    <div class="content" style="color: var(--text-secondary);">${result.content.substring(0, 200)}${result.content.length > 200 ? '...' : ''}</div>
                </div>
            `).join('');
        }

        async function getLLMExplanation(query, results) {
            const answerDiv = document.getElementById('llm-answer-container');
            answerDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Generating explanation...</div>';

            try {
                const response = await fetch(`${API_BASE}/compare`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        query: query,
                        top_k: 5,
                        alpha: 0.6,
                        ground_truth_ids: []
                    })
                });

                const data = await response.json();
                
                if (data.llm_answer) {
                    const html = marked.parse(data.llm_answer);
                    answerDiv.innerHTML = `
                        <div class="card">
                            <h2>AI Explanation</h2>
                            <div class="markdown-content">${html}</div>
                        </div>
                    `;
                }
            } catch (error) {
                answerDiv.innerHTML = `<div class="message error">Failed to generate explanation: ${error.message}</div>`;
            }
        }

        async function performCompare() {
            const query = document.getElementById('compare-query').value;
            const resultsDiv = document.getElementById('comparison-results');
            
            if (!query.trim()) {
                alert('Please enter a search query');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Comparing all search methods...</div>';

            try {
                const response = await fetch(`${API_BASE}/compare`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        query: query,
                        top_k: 5,
                        alpha: 0.6,
                        ground_truth_ids: []
                    })
                });

                const data = await response.json();
                displayComparison(data);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Comparison failed: ${error.message}</div>`;
            }
        }

        function displayComparison(data) {
            const resultsDiv = document.getElementById('comparison-results');
            
            const html = `
                <div class="card" style="margin-bottom: 30px;">
                    <h3>Performance Metrics</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div>
                            <div style="font-size: 1.5rem; font-weight: 700; margin-bottom: 5px;">${(data.metrics.vector_precision || 0).toFixed(3)}</div>
                            <div style="color: var(--text-secondary);">Vector Precision</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; font-weight: 700; margin-bottom: 5px;">${(data.metrics.graph_precision || 0).toFixed(3)}</div>
                            <div style="color: var(--text-secondary);">Graph Precision</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; font-weight: 700; margin-bottom: 5px;">${(data.metrics.hybrid_precision || 0).toFixed(3)}</div>
                            <div style="color: var(--text-secondary);">Hybrid Precision</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; font-weight: 700; margin-bottom: 5px;">${data.winner.toUpperCase()}</div>
                            <div style="color: var(--text-secondary);">Winner</div>
                        </div>
                    </div>
                </div>
                
                ${data.llm_answer ? `
                    <div class="card">
                        <h2>AI Explanation</h2>
                        <div class="markdown-content">${marked.parse(data.llm_answer)}</div>
                    </div>
                ` : ''}
            `;
            
            resultsDiv.innerHTML = html;
        }

        async function lookupNode() {
            const nodeId = document.getElementById('node-lookup-id').value;
            const container = document.getElementById('node-details-container');
            
            if (!nodeId.trim()) {
                alert('Please enter a node ID');
                return;
            }

            container.innerHTML = '<div class="loading"><div class="spinner"></div>Loading node...</div>';

            try {
                const response = await fetch(`${API_BASE}/nodes/${encodeURIComponent(nodeId)}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                container.innerHTML = `
                    <div class="card">
                        <h2>Node: ${data.node_id}</h2>
                        <div style="margin: 20px 0;">
                            <h3 style="margin-bottom: 10px;">Content</h3>
                            <div style="color: var(--text-secondary);">${data.content}</div>
                        </div>
                        <div style="margin: 20px 0;">
                            <h3 style="margin-bottom: 10px;">Relationships (${data.relationships.length})</h3>
                            ${data.relationships.length > 0 ? `
                                <div class="results-grid">
                                    ${data.relationships.map(rel => `
                                        <div class="result-card">
                                            <div class="score" style="display: inline-block; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; margin-bottom: 12px;">Weight: ${rel.weight.toFixed(2)}</div>
                                            <div><strong>${rel.source_id}</strong> ‚Üí <strong>${rel.target_id}</strong></div>
                                            <div style="color: var(--text-muted); font-size: 0.9em; margin-top: 8px;">Type: ${rel.relationship}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<p style="color: var(--text-muted);">No relationships</p>'}
                        </div>
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="editNode('${data.node_id}')">Edit Node</button>
                            <button class="btn btn-secondary" onclick="deleteNode('${data.node_id}')" style="background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); color: #ef4444;">Delete Node</button>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                container.innerHTML = `<div class="message error">‚ùå Failed to load node: ${error.message}</div>`;
            }
        }

        function editNode(nodeId) {
            const container = document.getElementById('node-details-container');
            const currentContent = container.querySelector('.content')?.textContent || '';
            
            const editForm = document.createElement('div');
            editForm.className = 'card';
            editForm.style.marginTop = '20px';
            editForm.innerHTML = `
                <h3>Edit Node: ${nodeId}</h3>
                <label style="display: block; margin-bottom: 8px; color: var(--text-secondary);">Content:</label>
                <textarea id="edit-content" class="search-input" style="min-height: 150px; font-family: inherit;">${currentContent}</textarea>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="saveNodeEdit('${nodeId}')">Save Changes</button>
                    <button class="btn btn-secondary" onclick="this.parentElement.parentElement.remove()">Cancel</button>
                </div>
            `;
            
            container.appendChild(editForm);
        }

        async function saveNodeEdit(nodeId) {
            const content = document.getElementById('edit-content').value.trim();

            try {
                const response = await fetch(`${API_BASE}/nodes/${encodeURIComponent(nodeId)}`, {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        content: content || null
                    })
                });

                if (response.ok) {
                    alert('Node updated successfully!');
                    document.getElementById('node-lookup-id').value = nodeId;
                    lookupNode();
                } else {
                    const error = await response.json();
                    alert('Failed to update node: ' + (error.error || 'Unknown error'));
                }
            } catch (error) {
                alert('Failed to update node: ' + error.message);
            }
        }

        async function deleteNode(nodeId) {
            if (!confirm(`Delete node "${nodeId}"?`)) return;

            try {
                const response = await fetch(`${API_BASE}/nodes/${encodeURIComponent(nodeId)}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    alert('Node deleted successfully!');
                    document.getElementById('node-details-container').innerHTML = '';
                    loadStats();
                } else {
                    alert('Failed to delete node');
                }
            } catch (error) {
                alert('Failed to delete node: ' + error.message);
            }
        }

        async function performTraversal() {
            const startId = document.getElementById('traversal-start').value;
            const depth = parseInt(document.getElementById('traversal-depth-slider').value) || 3;
            const maxNodes = parseInt(document.getElementById('traversal-max').value) || 100;
            const resultsDiv = document.getElementById('traversal-results');
            
            if (!startId.trim()) {
                alert('Please enter a start node ID');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Traversing graph...</div>';

            try {
                const response = await fetch(`${API_BASE}/search/graph?start_id=${encodeURIComponent(startId)}&depth=${depth}&max_nodes=${maxNodes}`);
                const data = await response.json();
                
                if (data.nodes && data.nodes.length > 0) {
                    resultsDiv.innerHTML = `
                        <h3 style="margin-bottom: 20px;">Traversal Results: ${data.nodes.length} nodes (Depth: ${data.depth})</h3>
                        <div class="results-grid">
                            ${data.nodes.map(node => `
                                <div class="result-card">
                                    <h3>${node.node_id}</h3>
                                    <div class="score" style="display: inline-block; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; margin-bottom: 12px;">Distance: ${node.distance}</div>
                                    <div class="content" style="color: var(--text-secondary);">${node.content.substring(0, 150)}...</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    // Removed guide reference
                    if (false) {
                    }
                } else {
                    resultsDiv.innerHTML = '<div class="message error">No nodes found</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Traversal failed: ${error.message}</div>`;
            }
        }

        async function loadGraph() {
            const container = document.getElementById('graph-container');
            
            try {
                container.innerHTML = '<div class="loading"><div class="spinner"></div>Loading graph...</div>';
                
                const response = await fetch(`${API_BASE}/graph`);
                const data = await response.json();
                
                if (!data.nodes || data.nodes.length === 0) {
                    container.innerHTML = '<div class="loading">No nodes in graph. Upload some files first!</div>';
                    return;
                }

                if (cy) cy.destroy();
                container.innerHTML = '';

                const elements = [];
                data.nodes.forEach(node => {
                    const nodeId = String(node.node_id || '');
                    if (!nodeId) return;
                    
                    // Use entity name (content) as label, fallback to node_id
                    let label = node.content || nodeId;
                    // If content is too long, truncate
                    if (label.length > 30) {
                        label = label.substring(0, 30) + '...';
                    }
                    // If it's an entity node, use the entity name
                    if (node.metadata && node.metadata.entity_type === 'extracted') {
                        label = node.content || nodeId;
                    }
                    
                    elements.push({
                        data: {
                            id: nodeId,
                            label: label,
                            content: node.content || nodeId,
                            node_type: node.node_type || node.metadata?.node_type || 'general',
                            is_entity: node.metadata?.entity_type === 'extracted',
                            has_embedding: true // All nodes have embeddings
                        }
                    });
                });
                
                if (data.edges) {
                    data.edges.forEach(edge => {
                        const source = String(edge.source || '');
                        const target = String(edge.target || '');
                        if (source && target) {
                            elements.push({
                                data: {
                                    id: `${source}-${target}`,
                                    source: source,
                                    target: target
                                }
                            });
                        }
                    });
                }

                cy = cytoscape({
                    container: container,
                    elements: elements,
                    style: [
                        {
                            selector: 'node',
                            style: {
                                'background-color': function(ele) {
                                    // Different colors for entities vs chunks
                                    return ele.data('is_entity') ? 'rgba(59, 130, 246, 0.9)' : 'rgba(255, 255, 255, 0.9)';
                                },
                                'label': 'data(label)',
                                'width': function(ele) {
                                    return ele.data('is_entity') ? 60 : 50;
                                },
                                'height': function(ele) {
                                    return ele.data('is_entity') ? 60 : 50;
                                },
                                'text-valign': 'center',
                                'text-halign': 'center',
                                'color': function(ele) {
                                    return ele.data('is_entity') ? '#fff' : '#000';
                                },
                                'font-size': '12px',
                                'font-weight': function(ele) {
                                    return ele.data('is_entity') ? 'bold' : 'normal';
                                },
                                'border-width': 2,
                                'border-color': function(ele) {
                                    return ele.data('is_entity') ? 'rgba(59, 130, 246, 1)' : 'rgba(255, 255, 255, 0.5)';
                                },
                                'shape': function(ele) {
                                    return ele.data('is_entity') ? 'ellipse' : 'roundrectangle';
                                }
                            }
                        },
                        {
                            selector: 'edge',
                            style: {
                                'width': 2,
                                'line-color': 'rgba(255, 255, 255, 0.4)',
                                'target-arrow-color': 'rgba(255, 255, 255, 0.4)',
                                'target-arrow-shape': 'triangle',
                                'curve-style': 'bezier'
                            }
                        }
                    ],
                    layout: {
                        name: 'cose',
                        idealEdgeLength: 100,
                        fit: true,
                        padding: 30
                    }
                });
                
                cy.on('tap', 'node', function(evt) {
                    const node = evt.target;
                    showNodeDetails(node);
                });
                
                // Add legend
                const legend = document.createElement('div');
                legend.style.cssText = 'position: absolute; top: 10px; right: 10px; background: var(--bg-glass-strong); padding: 15px; border-radius: 12px; border: 1px solid var(--border-glass); z-index: 1000;';
                legend.innerHTML = `
                    <div style="margin-bottom: 10px; font-weight: 600;">Legend</div>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 20px; height: 20px; background: rgba(59, 130, 246, 0.9); border-radius: 50%;"></div>
                        <span style="font-size: 0.9rem;">Entity Nodes</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 20px; height: 20px; background: rgba(255, 255, 255, 0.9); border-radius: 4px;"></div>
                        <span style="font-size: 0.9rem;">Content Nodes</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 20px; height: 2px; background: rgba(255, 255, 255, 0.4);"></div>
                        <span style="font-size: 0.9rem;">Relationships</span>
                    </div>
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border-glass); font-size: 0.85rem; color: var(--text-secondary);">
                        üí° All nodes have vector embeddings<br>
                        Click nodes to view details
                    </div>
                `;
                container.appendChild(legend);
                
            } catch (error) {
                container.innerHTML = `<div class="message error">Failed to load graph: ${error.message}</div>`;
            }
        }
        
        function showNodeDetails(node) {
            const nodeId = node.id();
            const nodeData = node.data();
            
            // Create a popup showing node details including embedding info
            const popup = document.createElement('div');
            popup.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--bg-glass-strong); backdrop-filter: blur(30px); border: 1px solid var(--border-glass); border-radius: 20px; padding: 30px; max-width: 600px; z-index: 10004; box-shadow: 0 20px 60px rgba(0,0,0,0.5);';
            popup.innerHTML = `
                <h2 style="margin-bottom: 20px;">Node Details: ${nodeId}</h2>
                <div style="margin-bottom: 15px;">
                    <strong>Label:</strong> ${nodeData.label || nodeId}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>Content:</strong> ${(nodeData.content || '').substring(0, 200)}${(nodeData.content || '').length > 200 ? '...' : ''}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>Type:</strong> ${nodeData.is_entity ? 'Entity Node' : 'Content Node'}
                </div>
                <div style="margin-bottom: 15px; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 8px;">
                    <strong>Vector Embedding:</strong> ‚úÖ Generated<br>
                    <span style="font-size: 0.9rem; color: var(--text-secondary);">
                        This node has a ${384}-dimensional vector embedding stored in ChromaDB for semantic search.
                    </span>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="viewNodeFromGraph('${nodeId}'); this.closest('div').remove();">View Full Details</button>
                    <button class="btn btn-secondary" onclick="this.closest('div').remove();">Close</button>
                </div>
            `;
            document.body.appendChild(popup);
            
            // Close on outside click
            setTimeout(() => {
                document.addEventListener('click', function closePopup(e) {
                    if (!popup.contains(e.target) && e.target !== node) {
                        popup.remove();
                        document.removeEventListener('click', closePopup);
                    }
                });
            }, 100);
        }
        
        function viewNodeFromGraph(nodeId) {
            document.getElementById('node-lookup-id').value = nodeId;
            switchTab('nodes');
            lookupNode();
        }

        async function loadPreviewGraph() {
            const container = document.getElementById('preview-graph');
            if (!container) return;
            
            try {
                const response = await fetch(`${API_BASE}/graph?limit=50`);
                const data = await response.json();
                
                if (!data.nodes || data.nodes.length === 0) {
                    container.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);">No graph data yet</div>';
                    return;
                }

                const elements = [];
                data.nodes.slice(0, 30).forEach(node => {
                    const nodeId = String(node.node_id || '');
                    if (nodeId) {
                        elements.push({
                            data: {
                                id: nodeId,
                                label: nodeId.substring(0, 15)
                            }
                        });
                    }
                });
                
                if (data.edges) {
                    data.edges.slice(0, 50).forEach(edge => {
                        if (edge.source && edge.target) {
                            elements.push({
                                data: {
                                    id: `${edge.source}-${edge.target}`,
                                    source: String(edge.source),
                                    target: String(edge.target)
                                }
                            });
                        }
                    });
                }

                if (elements.length > 0) {
                    const previewCy = cytoscape({
                        container: container,
                        elements: elements,
                        style: [
                            {
                                selector: 'node',
                                style: {
                                    'background-color': 'rgba(255, 255, 255, 0.9)',
                                    'label': 'data(label)',
                                    'width': 30,
                                    'height': 30,
                                    'text-valign': 'center',
                                    'text-halign': 'center',
                                    'color': '#000',
                                    'font-size': '10px'
                                }
                            },
                            {
                                selector: 'edge',
                                style: {
                                    'width': 1,
                                    'line-color': 'rgba(255, 255, 255, 0.3)',
                                    'target-arrow-color': 'rgba(255, 255, 255, 0.3)',
                                    'target-arrow-shape': 'triangle'
                                }
                            }
                        ],
                        layout: {
                            name: 'cose',
                            idealEdgeLength: 80,
                            fit: true,
                            padding: 20
                        }
                    });
                }
            } catch (error) {
                container.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);">Error loading preview</div>';
            }
        }

        // Autofill functions
        function autofillUpload() {
            // Create a demo text file
            const demoContent = `GraphMind Demo Document

This is a sample document for demonstration purposes. It contains information about artificial intelligence, machine learning, and knowledge graphs.

Key Concepts:
- Vector Search: Semantic similarity search using embeddings
- Graph Traversal: Exploring relationships between nodes
- Hybrid Search: Combining vector and graph methods

Machine Learning is a subset of artificial intelligence that enables systems to learn from data. Knowledge graphs represent information as interconnected nodes and edges, making it easy to discover relationships.

Natural Language Processing (NLP) is another important field that helps computers understand human language. When combined with knowledge graphs, NLP can extract entities and relationships from text.

This demo file will be processed to create nodes and edges in the knowledge graph.`;
            
            const blob = new Blob([demoContent], { type: 'text/plain' });
            const file = new File([blob], 'demo_document.txt', { type: 'text/plain' });
            document.getElementById('file-type').value = 'text';
            uploadFile(file);
        }
        
        function autofillVectorSearch() {
            document.getElementById('vector-query').value = 'machine learning artificial intelligence';
            document.getElementById('vector-top-k').value = 5;
            // Auto-trigger search after autofill
            setTimeout(() => performVectorSearch(), 300);
        }
        
        async function autofillGraphTraversal() {
            // Try to get a real node ID from the graph
            try {
                const response = await fetch(`${API_BASE}/graph?limit=10`);
                const data = await response.json();
                if (data.nodes && data.nodes.length > 0) {
                    // Prefer entity nodes
                    const entityNode = data.nodes.find(n => n.metadata?.entity_type === 'extracted');
                    const nodeId = entityNode ? entityNode.node_id : data.nodes[0].node_id;
                    document.getElementById('traversal-start-id').value = nodeId;
                } else {
                    document.getElementById('traversal-start-id').value = 'demo_node_1';
                }
            } catch {
                document.getElementById('traversal-start-id').value = 'demo_node_1';
            }
            document.getElementById('traversal-depth').value = 3;
            document.getElementById('traversal-max-nodes').value = 50;
            // Auto-trigger traversal after autofill
            setTimeout(() => performGraphTraversal(), 300);
        }
        
        function autofillHybridSearch() {
            document.getElementById('hybrid-query').value = 'artificial intelligence machine learning';
            document.getElementById('hybrid-vector-weight').value = 0.6;
            document.getElementById('hybrid-graph-weight').value = 0.4;
            document.getElementById('hybrid-top-k').value = 5;
            // Auto-trigger search after autofill
            setTimeout(() => performHybridSearch(), 300);
        }
        
        function autofillCompare() {
            document.getElementById('compare-query').value = 'knowledge graphs artificial intelligence';
            // Auto-trigger compare after autofill
            setTimeout(() => performCompare(), 300);
        }
        
        async function autofillNodeLookup() {
            // Try to get a real node ID from the graph
            try {
                const response = await fetch(`${API_BASE}/graph?limit=10`);
                const data = await response.json();
                if (data.nodes && data.nodes.length > 0) {
                    // Prefer entity nodes
                    const entityNode = data.nodes.find(n => n.metadata?.entity_type === 'extracted');
                    const nodeId = entityNode ? entityNode.node_id : data.nodes[0].node_id;
                    document.getElementById('node-lookup-id').value = nodeId;
                    // Auto-trigger lookup after autofill
                    setTimeout(() => lookupNode(), 300);
                } else {
                    document.getElementById('node-lookup-id').value = 'demo_node_1';
                }
            } catch {
                document.getElementById('node-lookup-id').value = 'demo_node_1';
            }
        }
        
        async function autofillTraversal() {
            // Try to get a real node ID from the graph
            try {
                const response = await fetch(`${API_BASE}/graph?limit=10`);
                const data = await response.json();
                if (data.nodes && data.nodes.length > 0) {
                    // Prefer entity nodes
                    const entityNode = data.nodes.find(n => n.metadata?.entity_type === 'extracted');
                    const nodeId = entityNode ? entityNode.node_id : data.nodes[0].node_id;
                    document.getElementById('traversal-start').value = nodeId;
                } else {
                    document.getElementById('traversal-start').value = 'demo_node_1';
                }
            } catch {
                document.getElementById('traversal-start').value = 'demo_node_1';
            }
            document.getElementById('traversal-depth-slider').value = 3;
            document.getElementById('depth-value').textContent = '3';
            document.getElementById('traversal-max').value = 50;
            // Auto-trigger traversal after autofill
            setTimeout(() => performTraversal(), 300);
        }
        
        function autofillCreateNode() {
            document.getElementById('create-node-content').value = 'Machine Learning is a subset of artificial intelligence that enables systems to learn from data.';
            document.getElementById('create-node-type').value = 'concept';
        }
        
        function autofillCreateEdge() {
            fetch(`${API_BASE}/graph?limit=2`)
                .then(res => res.json())
                .then(data => {
                    if (data.nodes && data.nodes.length >= 2) {
                        document.getElementById('create-edge-source').value = data.nodes[0].node_id;
                        document.getElementById('create-edge-target').value = data.nodes[1].node_id;
                    } else {
                        document.getElementById('create-edge-source').value = 'node_1';
                        document.getElementById('create-edge-target').value = 'node_2';
                    }
                })
                .catch(() => {
                    document.getElementById('create-edge-source').value = 'node_1';
                    document.getElementById('create-edge-target').value = 'node_2';
                });
            document.getElementById('create-edge-relationship').value = 'related_to';
            document.getElementById('create-edge-weight').value = 0.8;
        }
        
        async function createNode() {
            const nodeId = document.getElementById('create-node-id').value.trim();
            const content = document.getElementById('create-node-content').value.trim();
            const nodeType = document.getElementById('create-node-type').value.trim();
            const statusDiv = document.getElementById('crud-status');
            
            if (!content) {
                alert('Please enter node content');
                return;
            }
            
            statusDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Creating node...</div>';
            
            try {
                const payload = {
                    content: content,
                    metadata: nodeType ? { node_type: nodeType } : {}
                };
                if (nodeId) payload.id = nodeId;
                
                const response = await fetch(`${API_BASE}/nodes`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    statusDiv.innerHTML = `<div class="message success">‚úÖ Node created successfully! ID: ${result.node_id}</div>`;
                    loadStats();
                    
                } else {
                    statusDiv.innerHTML = `<div class="message error">‚ùå Failed to create node: ${result.error || 'Unknown error'}</div>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<div class="message error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        async function createEdge() {
            const source = document.getElementById('create-edge-source').value.trim();
            const target = document.getElementById('create-edge-target').value.trim();
            const relationship = document.getElementById('create-edge-relationship').value.trim();
            const weight = parseFloat(document.getElementById('create-edge-weight').value) || 1.0;
            const statusDiv = document.getElementById('crud-status');
            
            if (!source || !target || !relationship) {
                alert('Please fill all required fields');
                return;
            }
            
            statusDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Creating edge...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/edges`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        source_id: source,
                        target_id: target,
                        relationship: relationship,
                        weight: weight
                    })
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    statusDiv.innerHTML = `<div class="message success">‚úÖ Edge created successfully! ${source} ‚Üí ${target}</div>`;
                    loadStats();
                    
                } else {
                    statusDiv.innerHTML = `<div class="message error">‚ùå Failed to create edge: ${result.error || 'Unknown error'}</div>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<div class="message error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        async function clearAllData() {
            if (!confirm('Are you sure you want to clear ALL data? This will delete all nodes, edges, vectors, and files. This action cannot be undone.')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/data/clear`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(`‚úÖ All data cleared!\n\nNodes deleted: ${result.nodes_deleted}\nEdges deleted: ${result.edges_deleted}\nVectors deleted: ${result.vectors_deleted}\nFiles deleted: ${result.files_deleted}`);
                    loadStats();
                    refreshFiles();
                    loadPreviewGraph();
                } else {
                    alert('Failed to clear data');
                }
            } catch (error) {
                alert('Error clearing data: ' + error.message);
            }
        }
        
        // Search functions
        async function performVectorSearch() {
            const query = document.getElementById('vector-query').value;
            const topK = parseInt(document.getElementById('vector-top-k').value) || 5;
            const resultsDiv = document.getElementById('search-results');
            
            if (!query.trim()) {
                alert('Please enter a search query');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Searching...</div>';

            try {
                const response = await fetch(`${API_BASE}/search/vector`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ query_text: query, top_k: topK })
                });

                const data = await response.json();
                displaySearchResults(data.results);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Search failed: ${error.message}</div>`;
            }
        }
        
        async function performCompare() {
            const query = document.getElementById('compare-query').value;
            const resultsDiv = document.getElementById('comparison-results');
            
            if (!query.trim()) {
                alert('Please enter a search query');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Comparing all search methods...</div>';

            try {
                const response = await fetch(`${API_BASE}/compare`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        query: query,
                        top_k: 5,
                        alpha: 0.6,
                        ground_truth_ids: []
                    })
                });

                const data = await response.json();
                displayComparison(data);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Comparison failed: ${error.message}</div>`;
            }
        }
        
        async function performTraversal() {
            const startId = document.getElementById('traversal-start').value;
            const depth = parseInt(document.getElementById('traversal-depth-slider').value) || 3;
            const maxNodes = parseInt(document.getElementById('traversal-max').value) || 100;
            const resultsDiv = document.getElementById('traversal-results');
            
            if (!startId.trim()) {
                alert('Please enter a start node ID');
                return;
            }

            resultsDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Traversing graph...</div>';

            try {
                const response = await fetch(`${API_BASE}/search/graph?start_id=${encodeURIComponent(startId)}&depth=${depth}&max_nodes=${maxNodes}`);
                const data = await response.json();
                
                if (data.nodes && data.nodes.length > 0) {
                    resultsDiv.innerHTML = `
                        <h3 style="margin-bottom: 20px;">Traversal Results: ${data.nodes.length} nodes (Depth: ${data.depth})</h3>
                        <div class="results-grid">
                            ${data.nodes.map(node => `
                                <div class="result-card">
                                    <h3>${node.node_id}</h3>
                                    <div class="score" style="display: inline-block; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; margin-bottom: 12px;">Distance: ${node.distance}</div>
                                    <div class="content" style="color: var(--text-secondary);">${node.content.substring(0, 150)}...</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                } else {
                    resultsDiv.innerHTML = '<div class="message error">No nodes found</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="message error">‚ùå Traversal failed: ${error.message}</div>`;
            }
        }
        
        async function lookupNode() {
            const nodeId = document.getElementById('node-lookup-id').value;
            const container = document.getElementById('node-details-container');
            
            if (!nodeId.trim()) {
                alert('Please enter a node ID');
                return;
            }

            container.innerHTML = '<div class="loading"><div class="spinner"></div>Loading node...</div>';

            try {
                const response = await fetch(`${API_BASE}/nodes/${encodeURIComponent(nodeId)}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                container.innerHTML = `
                    <div class="card">
                        <h2>Node: ${data.node_id}</h2>
                        <div style="margin: 20px 0;">
                            <h3 style="margin-bottom: 10px;">Content</h3>
                            <div style="color: var(--text-secondary);">${data.content}</div>
                        </div>
                        <div style="margin: 20px 0;">
                            <h3 style="margin-bottom: 10px;">Relationships (${data.relationships.length})</h3>
                            ${data.relationships.length > 0 ? `
                                <div class="results-grid">
                                    ${data.relationships.map(rel => `
                                        <div class="result-card">
                                            <div class="score" style="display: inline-block; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px; margin-bottom: 12px;">Weight: ${rel.weight.toFixed(2)}</div>
                                            <div><strong>${rel.source_id}</strong> ‚Üí <strong>${rel.target_id}</strong></div>
                                            <div style="color: var(--text-muted); font-size: 0.9em; margin-top: 8px;">Type: ${rel.relationship}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<p style="color: var(--text-muted);">No relationships</p>'}
                        </div>
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="editNode('${data.node_id}')">Edit Node</button>
                            <button class="btn btn-secondary" onclick="deleteNode('${data.node_id}')" style="background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); color: #ef4444;">Delete Node</button>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                container.innerHTML = `<div class="message error">‚ùå Failed to load node: ${error.message}</div>`;
            }
        }

        // Initialize
        initOnboarding();
        switchSearchMode('vector');
        setInterval(loadStats, 30000); // Refresh stats every 30 seconds
    </script>
</body>
</html>

