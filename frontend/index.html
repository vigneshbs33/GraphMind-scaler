<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphMind - Hybrid Vector+Graph Database</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://unpkg.com/cytoscape@3.27.0/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <!-- Landing Page -->
    <div id="landing-page">
        <section class="landing-section" id="hero-section">
            <div class="section-content">
                <div class="hero">
                    <h1>GraphMind</h1>
                    <p class="hero-subtitle">Hybrid Vector + Graph Database for Intelligent AI Retrieval</p>
                    <p class="hero-description">
                        Transform your documents into intelligent knowledge graphs. Search semantically, traverse relationships, and discover insights with AI-powered explanations.
                    </p>
                    <div class="cta-buttons">
                        <button class="cta-button" onclick="startApp()">Launch Application</button>
                        <button class="cta-button cta-button-danger" onclick="clearAllData()">Clear All Data</button>
                    </div>
                    
                    <!-- Stats in Hero -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-nodes">0</div>
                            <div class="stat-label">Knowledge Nodes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-edges">0</div>
                            <div class="stat-label">Relationships</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-vectors">0</div>
                            <div class="stat-label">Vector Embeddings</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="landing-stat-files">0</div>
                            <div class="stat-label">Uploaded Files</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Main Application -->
    <div id="app-container" class="app-container">
        <div class="app-header">
            <div class="app-header-content">
                <div class="logo">GraphMind</div>
                <div class="nav-tabs">
                    <div class="nav-tab active" onclick="switchTab('upload')" data-tab="upload">Upload</div>
                    <div class="nav-tab" onclick="switchTab('search')" data-tab="search">Search</div>
                    <div class="nav-tab" onclick="switchTab('compare')" data-tab="compare">Compare</div>
                    <div class="nav-tab" onclick="switchTab('crud')" data-tab="crud">CRUD</div>
                    <div class="nav-tab" onclick="switchTab('nodes')" data-tab="nodes">Nodes</div>
                    <div class="nav-tab" onclick="switchTab('traversal')" data-tab="traversal">Traversal</div>
                    <div class="nav-tab" onclick="switchTab('graph')" data-tab="graph">Graph</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- Upload Tab -->
            <div id="upload-tab" class="tab-content active">
                <div class="card">
                    <h2>Upload Files</h2>
                    <div class="upload-zone" id="upload-zone">
                        <p class="upload-text">Drag and drop files here or click to browse</p>
                        <input type="file" id="file-input" multiple accept=".txt,.pdf,.xml,.json,.csv,.md" style="display: none;">
                        <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">Choose Files</button>
                        <button class="autofill-btn" onclick="autofillUpload()">ðŸŽ¯ Autofill Demo</button>
                        <div class="file-type-selector">
                            <label>File Type:</label>
                            <select id="file-type" class="search-input file-type-select">
                                <option value="text">Text (.txt)</option>
                                <option value="pdf">PDF (.pdf)</option>
                                <option value="xml">XML (.xml)</option>
                                <option value="json">JSON (.json)</option>
                                <option value="csv">CSV (.csv)</option>
                            </select>
                        </div>
                    </div>
                    <div id="upload-status"></div>
                    <div id="processing-animation" class="processing-animation">
                        <div class="spinner"></div>
                        <h3>Processing Your File...</h3>
                        <div class="processing-steps" id="processing-steps"></div>
                    </div>
                    <div id="transformation-visualization" class="transformation-visualization">
                        <h3 class="transformation-title">Data Transformation: Unstructured â†’ Structured</h3>
                        <div class="transformation-grid">
                            <div class="transformation-panel">
                                <h4>ðŸ“„ Unstructured Data</h4>
                                <div class="data-preview" id="unstructured-preview">
                                    <p class="preview-placeholder">Raw file content will appear here...</p>
                                </div>
                            </div>
                            <div class="transformation-panel">
                                <h4>ðŸ”— Structured Data</h4>
                                <div class="structured-data-tabs">
                                    <div class="tab-header">
                                        <button class="tab-btn active" onclick="switchTransformationTab('entities')">Entities</button>
                                        <button class="tab-btn" onclick="switchTransformationTab('nodes')">Nodes</button>
                                        <button class="tab-btn" onclick="switchTransformationTab('edges')">Edges</button>
                                        <button class="tab-btn" onclick="switchTransformationTab('embeddings')">Embeddings</button>
                                    </div>
                                    <div id="entities-tab" class="tab-content active">
                                        <div class="data-list" id="entities-list"></div>
                                    </div>
                                    <div id="nodes-tab" class="tab-content">
                                        <div class="data-list" id="nodes-list"></div>
                                    </div>
                                    <div id="edges-tab" class="tab-content">
                                        <div class="data-list" id="edges-list"></div>
                                    </div>
                                    <div id="embeddings-tab" class="tab-content">
                                        <div class="data-list" id="embeddings-list"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-nodes">0</div>
                        <div class="stat-label">Nodes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-edges">0</div>
                        <div class="stat-label">Edges</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-vectors">0</div>
                        <div class="stat-label">Vectors</div>
                    </div>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search-tab" class="tab-content">
                <div class="card">
                    <h2>Search Knowledge Graph</h2>
                    <div class="search-mode-tabs">
                        <div class="nav-tab" id="search-tab-vector" onclick="switchSearchMode('vector')">Vector</div>
                        <div class="nav-tab" id="search-tab-graph" onclick="switchSearchMode('graph')">Graph</div>
                        <div class="nav-tab active" id="search-tab-hybrid" onclick="switchSearchMode('hybrid')">Hybrid</div>
                    </div>
                    
                    <div id="search-vector" class="search-mode-content">
                        <div class="search-box">
                            <input type="text" id="vector-query" class="search-input" placeholder="Enter query for vector search...">
                            <input type="number" id="vector-top-k" class="search-input input-small" value="5" min="1" max="50" placeholder="Top K">
                            <button class="btn btn-primary" onclick="performVectorSearch()">Search</button>
                            <button class="autofill-btn" onclick="autofillVectorSearch()">ðŸŽ¯ Autofill</button>
                        </div>
                    </div>
                    
                    <div id="search-graph" class="search-mode-content">
                        <div class="search-box">
                            <input type="text" id="traversal-start-id" class="search-input" placeholder="Enter start node ID...">
                            <input type="number" id="traversal-depth" class="search-input input-small" value="3" min="1" max="10" placeholder="Depth">
                            <input type="number" id="traversal-max-nodes" class="search-input input-medium" value="100" min="1" max="1000" placeholder="Max Nodes">
                            <button class="btn btn-primary" onclick="performGraphTraversal()">Traverse</button>
                            <button class="autofill-btn" onclick="autofillGraphTraversal()">ðŸŽ¯ Autofill</button>
                        </div>
                    </div>
                    
                    <div id="search-hybrid" class="search-mode-content active">
                        <div class="search-box">
                            <input type="text" id="hybrid-query" class="search-input" placeholder="Enter query for hybrid search...">
                            <input type="number" id="hybrid-vector-weight" class="search-input input-medium" value="0.6" min="0" max="1" step="0.1" placeholder="Vector Weight">
                            <input type="number" id="hybrid-graph-weight" class="search-input input-medium" value="0.4" min="0" max="1" step="0.1" placeholder="Graph Weight">
                            <input type="number" id="hybrid-top-k" class="search-input input-small" value="5" min="1" max="50" placeholder="Top K">
                            <button class="btn btn-primary" onclick="performHybridSearch()">Search</button>
                            <button class="autofill-btn" onclick="autofillHybridSearch()">ðŸŽ¯ Autofill</button>
                        </div>
                    </div>
                    
                    <div id="search-results" class="results-grid"></div>
                    <div id="llm-answer-container"></div>
                </div>
            </div>

            <!-- Compare Tab -->
            <div id="compare-tab" class="tab-content">
                <div class="card">
                    <h2>Compare Search Methods</h2>
                    <div class="search-box">
                        <input type="text" id="compare-query" class="search-input" placeholder="Enter query to compare all methods...">
                        <button class="btn btn-primary" onclick="performCompare()">Compare</button>
                        <button class="autofill-btn" onclick="autofillCompare()">ðŸŽ¯ Autofill</button>
                    </div>
                    <div id="comparison-results"></div>
                </div>
            </div>

            <!-- CRUD Tab -->
            <div id="crud-tab" class="tab-content">
                <div class="card">
                    <h2>CRUD Operations</h2>
                    <div class="crud-grid">
                        <div class="card crud-card">
                            <h3>Create Node</h3>
                            <div class="crud-form">
                                <input type="text" id="create-node-id" class="search-input" placeholder="Node ID (optional)">
                                <textarea id="create-node-content" class="search-input textarea-input" placeholder="Node content..."></textarea>
                                <input type="text" id="create-node-type" class="search-input" placeholder="Node type (optional)">
                                <button class="btn btn-primary" onclick="createNode()">Create Node</button>
                                <button class="autofill-btn" onclick="autofillCreateNode()">ðŸŽ¯ Autofill</button>
                            </div>
                        </div>
                        <div class="card crud-card">
                            <h3>Create Edge</h3>
                            <div class="crud-form">
                                <input type="text" id="create-edge-source" class="search-input" placeholder="Source node ID">
                                <input type="text" id="create-edge-target" class="search-input" placeholder="Target node ID">
                                <input type="text" id="create-edge-relationship" class="search-input" placeholder="Relationship type">
                                <input type="number" id="create-edge-weight" class="search-input" value="1.0" min="0" max="1" step="0.1" placeholder="Weight (0-1)">
                                <button class="btn btn-primary" onclick="createEdge()">Create Edge</button>
                                <button class="autofill-btn" onclick="autofillCreateEdge()">ðŸŽ¯ Autofill</button>
                            </div>
                        </div>
                        <div class="card crud-card">
                            <h3>Auto-Relate Node</h3>
                            <p class="helper-text">Automatically connect a node to its most similar neighbors using cosine similarity.</p>
                            <div class="crud-form">
                                <input type="text" id="auto-relate-node-id" class="search-input" placeholder="Node ID to auto-relate">
                                <input type="number" id="auto-relate-top-k" class="search-input input-medium" value="3" min="1" max="20" placeholder="Top K similar nodes">
                                <input type="number" id="auto-relate-min-score" class="search-input input-medium" value="0.6" min="0" max="1" step="0.05" placeholder="Minimum similarity">
                                <input type="text" id="auto-relate-relationship" class="search-input" value="auto_related" placeholder="Relationship label">
                                <label class="checkbox-inline">
                                    <input type="checkbox" id="auto-relate-bidirectional"> Create reverse edges
                                </label>
                                <button class="btn btn-primary" onclick="autoRelateNode()">âš¡ Auto Relate</button>
                            </div>
                        </div>
                    </div>
                    <div id="crud-status"></div>
                </div>
            </div>

            <!-- Nodes Tab -->
            <div id="nodes-tab" class="tab-content">
                <div class="card">
                    <h2>Node Intelligence</h2>
                    <p class="helper-text">Search for any node by ID to view its content, connections, and an AI-generated summary powered by Gemini.</p>
                    <div class="search-box">
                        <input type="text" id="node-lookup-id" class="search-input" placeholder="Enter node ID (e.g., doc1)">
                        <button class="btn btn-primary" onclick="lookupNode()">View Node</button>
                        <button class="autofill-btn" onclick="autofillNodeLookup()">ðŸŽ¯ Autofill</button>
                    </div>
                    <div class="hint-card">
                        <p>ðŸ’¡ Tip: Click any search result or graph node to jump here automatically.</p>
                    </div>
                    <div id="node-details-container"></div>
                </div>
            </div>
            
            <!-- Traversal Tab -->
            <div id="traversal-tab" class="tab-content">
                <div class="card">
                    <h2>Graph Traversal</h2>
                    <div class="search-box">
                        <input type="text" id="traversal-start" class="search-input" placeholder="Enter start node ID...">
                        <div class="depth-control">
                            <label>Depth: <span id="depth-value">3</span></label>
                            <input type="range" id="traversal-depth-slider" min="1" max="10" value="3" 
                                   oninput="document.getElementById('depth-value').textContent = this.value">
                        </div>
                        <input type="number" id="traversal-max" class="search-input input-medium" value="100" min="1" max="1000" placeholder="Max Nodes">
                        <button class="btn btn-primary" onclick="performTraversal()">Start Traversal</button>
                        <button class="autofill-btn" onclick="autofillTraversal()">ðŸŽ¯ Autofill</button>
                    </div>
                    <div id="traversal-results"></div>
                    <div id="traversal-graph-container"></div>
                </div>
            </div>

            <!-- Graph Tab -->
            <div id="graph-tab" class="tab-content">
                <div class="card">
                    <h2>Interactive Graph Visualization</h2>
                    <button class="btn btn-primary" onclick="loadGraph()">Refresh Graph</button>
                    <div id="graph-container"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Onboarding Overlay -->
    <div id="onboarding-overlay" class="onboarding-overlay">
        <div class="onboarding-popup">
            <div class="step-indicator" id="step-indicator"></div>
            <h2 id="onboarding-title">Welcome to GraphMind</h2>
            <p id="onboarding-content"></p>
            <div class="popup-buttons">
                <button class="btn btn-secondary" onclick="skipOnboarding()">Skip</button>
                <button class="btn btn-primary" onclick="nextOnboardingStep()" id="onboarding-next">Next</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>